<link rel="stylesheet" href="/css/project.css">
<link rel="stylesheet" href="/css/cms/project.css">

<img src=<%=project.image%>>
<article class="project container">

    <div class="btn-wrapper">
        <div id="edit" class="btn selected btn-project-view">edit</div>
        <div id="preview" class="btn btn-project-view">preview</div>
    </div>
    <form action="/api/projects" method="POST" class="">
        <div class="project-preview hidden">
            <%- project.contentHTML %>
        </div>
        <div class="project-edit">
            <%- include ('./partials/form-fields.ejs') %>
        </div>

        <button type="submit" class="btn btn-dark">Save</button>
        <a href="/cms/projects" class="btn btn-light">Cancel</a>
    </form>


    <form action="/api/projects/<%= project.slug %>?_method=DELETE" method="POST">
        <button type="submit" class="btn btn-danger">Delete</div>
    </form>
</article>

<script>
    let buttons = document.getElementsByClassName('btn-project-view');
    Array.from(buttons).forEach(btn => {
        btn.addEventListener('click', event => {
            Array.from(document.getElementsByClassName('btn-project-view')).forEach(btn => {
                btn.classList.remove("selected");
            });
            if (event.target.id == "edit") {
                document.querySelector('.project-preview').classList.add('hidden');
                document.querySelector('.project-edit').classList.remove('hidden');
            } else if(event.target.id =="preview") {
                document.querySelector('.project-edit').classList.add('hidden');
                document.querySelector('.project-preview').classList.remove('hidden');
            }
            btn.classList.add("selected");
        });
    });
</script>
